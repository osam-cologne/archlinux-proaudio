# Maintainer: OSAMC <https://github.com/osam-cologne/archlinux-proaudio>
# Contributor: Florian HÃ¼lsmann <fh@cbix.de>

pkgbase=ola
pkgname=ola
pkgver=0.10.8
pkgrel=1
pkgdesc='Open Lighting Architecture for controlling entertainment lighting equipment'
arch=(x86_64 aarch64)
url='https://www.openlighting.org'
license=(LGPL2.1 GPL2)
depends=()
makedepends=(avahi cppunit doxygen flake8 libmicrohttpd protobuf)
source=("${pkgbase}-${pkgver}.tar.gz::https://github.com/OpenLightingProject/${pkgbase}/archive/refs/tags/${pkgver}.tar.gz")
sha256sums=('45bc101d1ddcc1c6320c063eb25a9345e5820a4233acfa5b29f2dfd99f7452e1')

build() {
  cd "$srcdir"/${pkgbase}-${pkgver}
  autoreconf -i
  ./configure --prefix=/usr
  make
  make doxygen-doc
}

check() {
  cd "$srcdir"/${pkgbase}-${pkgver}
  make check ||
    echo "Ignoring failing tests"
}

package() {
  cd "$srcdir"/${pkgbase}-${pkgver}
  make DESTDIR="$pkgdir" install
}
